import os
import sys

sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(__file__), '../')))

from exploit.bof_exploit import OverflowExploit
from exploit.string_bug import FormatStringExploit
from dispatcher import Dispatcher

class Exploit:
    def __init__(self, config):
        self.config = config


    def run_bof_exploit(self):
        bof_exploit = OverflowExploit(self.config)
        bof_index = bof_exploit.try_overflow()
        return bof_index

    def run_string_bug_exploit(self):
        dispatcher = Dispatcher(self.config)
        if not dispatcher.is_connected():
            dispatcher.connect()
        string_exploit = FormatStringExploit(dispatcher)
        return string_exploit.find_offset(max_offset=100)